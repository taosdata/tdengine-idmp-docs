# 数据可视化

IDMP 内置了 Grafana 风格的数据可视化 (Data Visualization) 模块，它提供面板和看板。看板由一系列的面板组成，全部是拖拽操作，操作简单直接，本文档不做任何专门介绍。

任何一个元素都可以有自己的面板和看板。对于树状结构里的每个元素，因为所处层次的不同，不同层次的元素关心的指标会不一样。比如电力集团一级的面板关心的是整个集团的总发电量、总成本等，而到风机一级，关心的是这台风机的状态、发电效率等。IDMP 的这种设计适合企业管理的架构。

### 面板的基本操作

IDMP 面板支持趋势图、柱状图、饼图、仪表盘、统计值、富文本、表格等，后续还将支持散点图、地图、组态、热力图、事件分析图等。
查看面板时，点击面板上方的动作区的图标，你可以编辑、收藏、设置显示的时间段范围、刷新的频次、下载为图片，也可以放大某一显示区域、全屏展示等。面板的下方是图例，点击它可以隐藏或显示某个指标。
点击编辑按钮，对面板进行编辑。下面对面板的编辑操作做较为详细的介绍。

### 面板展示的数据类型

一个元素自身有很多属性，这些属性可以展示出来。同时，一个元素可能有多个子元素，子元素的子元素等，这些子元素之间的聚合计算会产生很多新的指标，也可以展示出来。因此在创建一个元素的面板时，在左侧树状结构区，你可以选择：

1. 元素：你可以选择本元素的属性，也可以选择该元素下面的子元素的属性作为展示的指标。但系统仅仅列出数据引用为 TDengine Metric 的属性，因为他们才是时序类数据，需要展示。
2. 子元素聚合：你可以选择本元素所拥有的子元素的子元素模板，然后选择对这个子元素模板的哪个属性进行聚合，同时可以选择一个或多个维度指标。

缺省的选择是“元素”。在左侧树状结构，选择一个具体属性或标签，鼠标双击就行。

### 面板指标 (Mertrics) 的配置

你可以对每个被选中的指标做如下的配置：

1. 名称 (Name):  这是在 Panel 上展示的指标的名字，缺省就是属性的名字。
2. 表达式 (Expression): IDMP 容许你在选中的属性上进行表达式计算，甚至选择多个属性进行计算。
3. 函数 (Function)：当“窗口”被设置或者有分组的“维度”选择时，表示聚合函数，缺省是 AVG。
4. 过滤条件 (Conditions):  对原始值进行过滤的条件，以筛选数据。
5. 时间偏移 (Time Shift): 将被展示的指标的时间戳进行偏移，用于不同时间段的趋势对比。比如设置为 -1d, 表示展示的是该指标一天前对应的数据。
6. 预测 (Prediction): 点击可以对该指标进行时序数据预测的设置
7. 排序 (Order by):  点击可以选择对指标进行排序，缺省是不排。

对于所有展示的指标，在指标列表的右上角，你还可以设置：

1. 窗口 (Window)：对指标进行滑动窗口的聚合，你可以设置滑动时长以及聚合窗口的时长，缺省是不设置。
2. 限制 (Limit): 限制指标数据展示的最大条数

### 面板维度 (Dimensions) 的配置

### 面板的可视化设置

面板处于编辑状态时，点击面板上方动作区最右侧的按钮，可以对展示做各种配置。每种面板的可视化配置参数与 Grafana 高度一致，而且因为配置的修改都将立即展示出来，所见即所得，因此本文档将不做专门介绍。
